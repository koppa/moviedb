from random import randint
from pathlib import Path
from nose.tools import assert_equal
from lib.helper_index import search_moviedir

#TODO add support for other websites for example rotten tomatoes

def test_search_moviedir():
    # SETUP files
    target = Path('/tmp/{}'.format(randint(0, 10000)))
    while target.exists():
        target = Path('/tmp/{}'.format(randint(0, 10000)))

    target.mkdir()
    for string in test_strings:
        nfo = target / "test.nfo"
        with nfo.open('w') as fh:
            fh.write(string)

        result = search_moviedir(target)
        assert_equal(result, 'tt0450278')
        nfo.unlink()


test_strings = [u"""
                                       �
                               ���        �          �
                     �          ���      ��         ���
                                  ���    ��        ����
                                   ���   ��  �     ���   �
                     �      ۲     ���   ���      ���
                     ��    �  �    ���   ���      ���
                     ۰��   ۲    ����  � ���     ���    �
                      �۲�        ����     ���    ����   �
                        ��        ���   � �  ��    ���� ��       �
        �     �����     ���     �      ۲�    ��    ��  ��
             ��   �۲   ���    ��       �      ����    ���
         �  �  ��  ��   ���   ���   ��           ���� ���         �
         �  �  �    �   ���   ���  ���             ��� ����       �    �
        ��  �      ��   ���  ���  ��     �����      �� �����     ��
        ��   ��   ��    ��� ���   �     �    �۲    ��۰����    ���      �
        ��    �����     ��� ���  ��    �  ��  ��    ��۲�����   ���  ��  �
        ��             ���� ���� ���   � ��    �    ���   ����  ���  �� ۲
        ����          �۲��  ��� ���   �      ��    ���    ���� ���  � ۲
        ���۲        ��۲��  ���۰����  ��  ���    ����     ���� ����� ۲
       ��۲��      ���� ���   ��۲����   ����      ����  �   ��� ����� �۲
       ��۰���    ����  ����    �۲���            ����  ۲�   ��  ����  ۲
      ���  ����   ���    ����     ۲��    ���    ����    �    ��   ���  ��
     ����   ���   ��      ���     �����    ���������          ��    ��� ���
    ����    ���   ��   ��   �۲����۲��         �            ���     �� ��۰
   �����    ���  ���  �  �           ��       ���          ����     ���  �۰
   ����    ����   ���  ��     ���    ��    �����۰�      �����     ����� ��۰�
   ����    ۲�    ����      ����          ��������۰��  �����     ������  �����
   ����� �����     ����   ����       �   ������  ���۲������     ������    ����
    ����� ���       ���  ���        �۲  ����         ۲��      �����        ��
                                                               �
 ��   �� ��� �������  ��������   ��������   �������  ��������    ��     �������
 ��  ���   ���������� ��������  ���������� ��������  ������۲  ����    ���������
 ��  ��  �۲���   ��� ����     �����    �������  ��  ����      ����    ���    ��
 �� ��   � ���     �� ��       ���       ����         ���     ��� �    ��     ��
 �� ��  �� ��      �� ������������       �۲�������   ���    ���� ��   ��    ���
 �� ��  �� ��     ��� �����    ��        �۲��������  ��     ���  ��   ��   ���
 �۲�   �  ��    ���  �        ��       ��       ��   ��    ���   ��   ������
 ����   �  ��   ���   �        ��      ����      ��   ��   ���� ����   ����
 ���   ��  �������   ��   ���  ���    �����    ���    ��   ���������   �۲�
 ��    ��  �����     �������    ��������  ۲����      ��   �����   ��  �۲���۲
     �           �   �����       �����    ����        ��   ��           ۲
    ���          ���        ����               ������                         ��
   ������������  �����   �    ���۰��������������      �����������۲��� �    ���
  ������           ���� ۲�     �������������   � ����������    �          ����
  ���                    �                    � ��������������   ����   ������
  �  �������������������������������������� ��    ���������۲       ���    ���
  � ���   �     ��������������     ��   �    ��� � �����      ����۰ ����   ���
  � ۰ ��  �    ��������������    ۰ ��  �     ���        ����۱���۰�  ���  ���
  � �  �� ��     �۰�������۲     �  �� ��       ��  �   �    �������۰� ���   �
    ��  ���       �����۲���       �  ���          ��    ���  ���������۰  ��
  � � ����           ��۲           ����            ��� �  ��   ��������۰ ���
    �   ���۲      ����۲��      ���۰                ���   ��� �������۰    ��
    �      �������۰�������������۲             ���     �� �  �����          ���
    �      ���������������������۲�    ��    ���         ��               ������
  � �      ����۰��������۰��������� ��۰ ���             �� �     �������۲
    �     ����۰������������۰��������۲�                  ��  ���۲
    �    ������۰ VideoStar ����������۲� �������������     ����
    �    ��������������������������۲�۲�
    �    ���۲��۰�����������۰����� ��۰ ���
    �      ������������������������    ��    ���
    �        ��������������������               ���
    �
    �
    �
    �
    �             Hostel Extended Version (2005)
    �
    �
    �
    �             RELEASEDATE ..... : 23.05.2011
    �             CiNE DATE ....... : 27.04.2006
    �             GENRE ........... : Horror | Mystery | Thriller
    �             SiZE ............ : 77 x 100 MB
    �             RUNTiME ......... : 1h 33min.
    �             FSK ............. : 18
    �             ViDEO SOURCE .... : Blu-Ray Disc
    �             RESOLUTiON ...... : 1920 x 816
    �             ViDEO ........... : x264 @ 7603 kbps  (CRF20)
    �             AUDiO ........... : German  DTS @ 1510 kbps
    �                                 English DTS @ 1510 kbps
    �             SUBTiTLES ....... : No
    � ����
    ���   �       iMDB ............ : http://www.imdb.com/title/tt0450278/
    ۰ ��  �
    �  �� ��
    ��  ���
     ��������������������������������������������������������������
                                                             ��   ��
                                                            ۰ ��  �
                                                            �  �� ��
                                                             �  ����
     ��������������������������������������������������������������
    ���   �
    ۰ ��  �
    �  �� ��
    ��  ���
    � ����
    �             G R O U P   N O T E S
    �
    �             Search:
    �
    �
    �             C O N T A C T
    �             videostar@hush.ai
    ۰
    ��
    ��
    ��
    ����                                   �������������������
    �۰�                               ���۲��������������������
     ۲���                            ۲����    �������������  ��
      ۲����                       ������ �    ۲��������������  ��
       �۲����                    ۰�������    �۲�������������� ���
        ��۲�����                ۰��������� �   ۲��������������   �
           ��۲�����           �۰�������   �     ۲��������������  �
             ��۲���������   ��۰�������     �     ۲��������������  ��
                ��۰�������۰�۰�������      � �   �۲��������������   �
                   ���۰�����۰������        ��     �۲��������������   �
                       �����۲��              ��     ۲������           ��
                                               � �   �����               ��
                                               ��              �������    ��
                                                ��        �����۲������   ��
                                                 �      �۲������������     �
                                                 � �    ۲���������������   ��
                                                  �      ۲��������������    �
                                                  �      ۲���������������   ��
                                                  ��      ۲��������������     �
                                                   �      ۲��������������
                                                   � �     ۰�����sDG�����
                                                   ��       ۰����۲������
                                                    �       ����۰�����
                                                    ��
                                                     � �
                                                      �
""",
               u"""
                                       �
                               ���        �          �
                     �          ���      ��         ���
                                  ���    ��        ����
                                   ���   ��  �     ���   �
                     �      ۲     ���   ���      ���
                     ��    �  �    ���   ���      ���
                     ۰��   ۲    ����  � ���     ���    �
                      �۲�        ����     ���    ����   �
                        ��        ���   � �  ��    ���� ��       �
        �     �����     ���     �      ۲�    ��    ��  ��
             ��   �۲   ���    ��       �      ����    ���
         �  �  ��  ��   ���   ���   ��           ���� ���         �
         �  �  �    �   ���   ���  ���             ��� ����       �    �
        ��  �      ��   ���  ���  ��     �����      �� �����     ��
        ��   ��   ��    ��� ���   �     �    �۲    ��۰����    ���      �
        ��    �����     ��� ���  ��    �  ��  ��    ��۲�����   ���  ��  �
        ��             ���� ���� ���   � ��    �    ���   ����  ���  �� ۲
        ����          �۲��  ��� ���   �      ��    ���    ���� ���  � ۲
        ���۲        ��۲��  ���۰����  ��  ���    ����     ���� ����� ۲
       ��۲��      ���� ���   ��۲����   ����      ����  �   ��� ����� �۲
       ��۰���    ����  ����    �۲���            ����  ۲�   ��  ����  ۲
      ���  ����   ���    ����     ۲��    ���    ����    �    ��   ���  ��
     ����   ���   ��      ���     �����    ���������          ��    ��� ���
    ����    ���   ��   ��   �۲����۲��         �            ���     �� ��۰
   �����    ���  ���  �  �           ��       ���          ����     ���  �۰
   ����    ����   ���  ��     ���    ��    �����۰�      �����     ����� ��۰�
   ����    ۲�    ����      ����          ��������۰��  �����     ������  �����
   ����� �����     ����   ����       �   ������  ���۲������     ������    ����
    ����� ���       ���  ���        �۲  ����         ۲��      �����        ��
                                                               �
 ��   �� ��� �������  ��������   ��������   �������  ��������    ��     �������
 ��  ���   ���������� ��������  ���������� ��������  ������۲  ����    ���������
 ��  ��  �۲���   ��� ����     �����    �������  ��  ����      ����    ���    ��
 �� ��   � ���     �� ��       ���       ����         ���     ��� �    ��     ��
 �� ��  �� ��      �� ������������       �۲�������   ���    ���� ��   ��    ���
 �� ��  �� ��     ��� �����    ��        �۲��������  ��     ���  ��   ��   ���
 �۲�   �  ��    ���  �        ��       ��       ��   ��    ���   ��   ������
 ����   �  ��   ���   �        ��      ����      ��   ��   ���� ����   ����
 ���   ��  �������   ��   ���  ���    �����    ���    ��   ���������   �۲�
 ��    ��  �����     �������    ��������  ۲����      ��   �����   ��  �۲���۲
     �           �   �����       �����    ����        ��   ��           ۲
    ���          ���        ����               ������                         ��
   ������������  �����   �    ���۰��������������      �����������۲��� �    ���
  ������           ���� ۲�     �������������   � ����������    �          ����
  ���                    �                    � ��������������   ����   ������
  �  �������������������������������������� ��    ���������۲       ���    ���
  � ���   �     ��������������     ��   �    ��� � �����      ����۰ ����   ���
  � ۰ ��  �    ��������������    ۰ ��  �     ���        ����۱���۰�  ���  ���
  � �  �� ��     �۰�������۲     �  �� ��       ��  �   �    �������۰� ���   �
    ��  ���       �����۲���       �  ���          ��    ���  ���������۰  ��
  � � ����           ��۲           ����            ��� �  ��   ��������۰ ���
    �   ���۲      ����۲��      ���۰                ���   ��� �������۰    ��
    �      �������۰�������������۲             ���     �� �  �����          ���
    �      ���������������������۲�    ��    ���         ��               ������
  � �      ����۰��������۰��������� ��۰ ���             �� �     �������۲
    �     ����۰������������۰��������۲�                  ��  ���۲
    �    ������۰ VideoStar ����������۲� �������������     ����
    �    ��������������������������۲�۲�
    �    ���۲��۰�����������۰����� ��۰ ���
    �      ������������������������    ��    ���
    �        ��������������������               ���
    �
    �
    �
    �
    �             Hostel Extended Version (2005)
    �
    �
    �
    �             RELEASEDATE ..... : 23.05.2011
    �             CiNE DATE ....... : 27.04.2006
    �             GENRE ........... : Horror | Mystery | Thriller
    �             SiZE ............ : 77 x 100 MB
    �             RUNTiME ......... : 1h 33min.
    �             FSK ............. : 18
    �             ViDEO SOURCE .... : Blu-Ray Disc
    �             RESOLUTiON ...... : 1920 x 816
    �             ViDEO ........... : x264 @ 7603 kbps  (CRF20)
    �             AUDiO ........... : German  DTS @ 1510 kbps
    �                                 English DTS @ 1510 kbps
    �             SUBTiTLES ....... : No
    � ����
    ���   �       iMDB ............ : http://www.imdb.com/title/tt0450278
    ۰ ��  �
    �  �� ��
    ��  ���
     ��������������������������������������������������������������
                                                             ��   ��
                                                            ۰ ��  �
                                                            �  �� ��
                                                             �  ����
     ��������������������������������������������������������������
    ���   �
    ۰ ��  �
    �  �� ��
    ��  ���
    � ����
    �             G R O U P   N O T E S
    �
    �             Search:
    �
    �
    �             C O N T A C T
    �             videostar@hush.ai
    ۰
    ��
    ��
    ��
    ����                                   �������������������
    �۰�                               ���۲��������������������
     ۲���                            ۲����    �������������  ��
      ۲����                       ������ �    ۲��������������  ��
       �۲����                    ۰�������    �۲�������������� ���
        ��۲�����                ۰��������� �   ۲��������������   �
           ��۲�����           �۰�������   �     ۲��������������  �
             ��۲���������   ��۰�������     �     ۲��������������  ��
                ��۰�������۰�۰�������      � �   �۲��������������   �
                   ���۰�����۰������        ��     �۲��������������   �
                       �����۲��              ��     ۲������           ��
                                               � �   �����               ��
                                               ��              �������    ��
                                                ��        �����۲������   ��
                                                 �      �۲������������     �
                                                 � �    ۲���������������   ��
                                                  �      ۲��������������    �
                                                  �      ۲���������������   ��
                                                  ��      ۲��������������     �
                                                   �      ۲��������������
                                                   � �     ۰�����sDG�����
                                                   ��       ۰����۲������
                                                    �       ����۰�����
                                                    ��
                                                     � �
                                                      �
"""]
